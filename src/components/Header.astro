---
const navItems = [
  { href: "/", label: "Home", icon: "home" },
  { href: "/me", label: "About", icon: "user" },
  { href: "/projects", label: "Projects", icon: "code" },
  { href: "/articles", label: "Articles", icon: "pen" },
];

const currentPath = Astro.url.pathname;
---

<header class="header">
  <nav class="nav container">
    <ul class="nav-list">
      {
        navItems.map((item) => (
          <li>
            <a
              href={item.href}
              class:list={[
                "nav-link",
                {
                  active:
                    currentPath === item.href ||
                    (item.href !== "/" && currentPath.startsWith(item.href)),
                },
              ]}
              aria-label={item.label}
            >
              {item.icon === "home" && (
                <svg
                  class="nav-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                </svg>
              )}
              {item.icon === "user" && (
                <svg
                  class="nav-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                  <circle cx="12" cy="7" r="4" />
                </svg>
              )}
              {item.icon === "code" && (
                <svg
                  class="nav-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <polyline points="16 18 22 12 16 6" />
                  <polyline points="8 6 2 12 8 18" />
                </svg>
              )}
              {item.icon === "pen" && (
                <svg
                  class="nav-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M12 19l7-7 3 3-7 7-3-3z" />
                  <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" />
                  <path d="M2 2l7.586 7.586" />
                  <circle cx="11" cy="11" r="2" />
                </svg>
              )}
              <span class="nav-label">{item.label}</span>
            </a>
          </li>
        ))
      }
    </ul>

    <button class="theme-toggle" aria-label="Toggle theme" id="theme-toggle">
      <svg
        class="sun-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <circle cx="12" cy="12" r="5"></circle>
        <line x1="12" y1="1" x2="12" y2="3"></line>
        <line x1="12" y1="21" x2="12" y2="23"></line>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
        <line x1="1" y1="12" x2="3" y2="12"></line>
        <line x1="21" y1="12" x2="23" y2="12"></line>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
      </svg>
      <svg
        class="moon-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
      </svg>
    </button>
  </nav>
</header>

<style>
  .header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background-color: var(--color-bg);
    border-bottom: 1px solid var(--color-border-subtle);
    backdrop-filter: blur(10px);
  }

  .nav {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 70px;
    position: relative;
  }

  .logo {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background-color: var(--color-accent);
    border-radius: var(--radius-md);
    color: white;
    font-weight: 700;
    font-size: var(--text-lg);
    text-decoration: none;
    transition: transform var(--transition-base);
  }

  .logo:hover {
    transform: scale(1.05);
  }

  .nav-list {
    display: flex;
    list-style: none;
    gap: var(--space-2);
  }

  .nav-link {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-4);
    color: var(--color-text-secondary);
    text-decoration: none;
    border-radius: var(--radius-md);
    transition: all var(--transition-base);
  }

  .nav-link:hover,
  .nav-link.active {
    color: var(--color-text);
    background-color: var(--color-bg-subtle);
  }

  .nav-icon {
    width: 18px;
    height: 18px;
  }

  .nav-label {
    font-size: var(--text-sm);
    font-weight: 500;
  }

  .theme-toggle {
    position: absolute;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: none;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all var(--transition-base);
  }

  .theme-toggle:hover {
    color: var(--color-text);
    border-color: var(--color-text-muted);
  }

  .theme-toggle svg {
    width: 18px;
    height: 18px;
  }

  .sun-icon {
    display: none;
  }
  .moon-icon {
    display: block;
  }

  :global([data-theme="light"]) .sun-icon {
    display: block;
  }
  :global([data-theme="light"]) .moon-icon {
    display: none;
  }

  @media (max-width: 640px) {
    .nav-label {
      display: none;
    }

    .nav-link {
      padding: var(--space-2);
    }
  }
</style>

<script>
  const toggle = document.getElementById("theme-toggle");
  toggle?.addEventListener("click", () => {
    const current = document.documentElement.getAttribute("data-theme");
    const next = current === "dark" ? "light" : "dark";
    document.documentElement.setAttribute("data-theme", next);
    localStorage.setItem("theme", next);
  });
</script>
